<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="学习总结 思考感悟 知识管理">
<meta property="og:type" content="website">
<meta property="og:title" content="pingtingpeng&#39;s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="pingtingpeng&#39;s blog">
<meta property="og:description" content="学习总结 思考感悟 知识管理">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="pingtingpeng&#39;s blog">
<meta name="twitter:description" content="学习总结 思考感悟 知识管理">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>pingtingpeng's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">pingtingpeng's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/28/webpack打包原理分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/28/webpack打包原理分析/" itemprop="url">webpack打包原理分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-28T23:55:35+08:00">
                2020-05-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>既然是分析打包原理，先看看webpack打包后的代码：<br><em>说明：webpack version:4.43.0,项目结构：</em><br>|——dist<br>|——lib<br>|——src——|——index.js<br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|——hello.js<br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|——a.js<br>|<br>|——bundle.js<br>|——package.json<br>|——webpack.config.js<br><em>已去掉注释,入口文件为index.js,index.js引用hello.js,hello.js引用a.js</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"> (<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>) </span>&#123; </span><br><span class="line"></span><br><span class="line"> 	<span class="keyword">var</span> installedModules = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"> 	<span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(installedModules[moduleId]) &#123;</span><br><span class="line">			<span class="keyword">return</span> installedModules[moduleId].exports;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> <span class="built_in">module</span> = installedModules[moduleId] = &#123;</span><br><span class="line">			i: moduleId,</span><br><span class="line">			l: <span class="literal">false</span>,</span><br><span class="line">		  exports: &#123;&#125;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		modules[moduleId].call(<span class="built_in">module</span>.exports, <span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">module</span>.l = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">	&#125;</span><br><span class="line">	__webpack_require__.m = modules;</span><br><span class="line"></span><br><span class="line"> 	__webpack_require__.c = installedModules;</span><br><span class="line"></span><br><span class="line">	__webpack_require__.d = <span class="function"><span class="keyword">function</span>(<span class="params">exports, name, getter</span>) </span>&#123;</span><br><span class="line"> 		<span class="keyword">if</span>(!__webpack_require__.o(exports, name)) &#123;</span><br><span class="line">			<span class="built_in">Object</span>.defineProperty(exports, name, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">get</span>: getter &#125;);</span><br><span class="line"> 		&#125;</span><br><span class="line">   &#125;;</span><br><span class="line">   </span><br><span class="line"> 	__webpack_require__.r = <span class="function"><span class="keyword">function</span>(<span class="params">exports</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">Symbol</span> !== <span class="string">'undefined'</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag) &#123;</span><br><span class="line">		<span class="built_in">Object</span>.defineProperty(exports, <span class="built_in">Symbol</span>.toStringTag, &#123; <span class="attr">value</span>: <span class="string">'Module'</span> &#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	  <span class="built_in">Object</span>.defineProperty(exports, <span class="string">'__esModule'</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line"> 	__webpack_require__.t = <span class="function"><span class="keyword">function</span>(<span class="params">value, mode</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(mode &amp; <span class="number">1</span>) value = __webpack_require__(value);</span><br><span class="line">		<span class="keyword">if</span>(mode &amp; <span class="number">8</span>) <span class="keyword">return</span> value;</span><br><span class="line"> 		<span class="keyword">if</span>((mode &amp; <span class="number">4</span>) &amp;&amp; <span class="keyword">typeof</span> value === <span class="string">'object'</span> &amp;&amp; value &amp;&amp; value.__esModule) <span class="keyword">return</span> value;</span><br><span class="line"> 		<span class="keyword">var</span> ns = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">	  __webpack_require__.r(ns);</span><br><span class="line">	  <span class="built_in">Object</span>.defineProperty(ns, <span class="string">'default'</span>, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">value</span>: value &#125;);</span><br><span class="line">		<span class="keyword">if</span>(mode &amp; <span class="number">2</span> &amp;&amp; <span class="keyword">typeof</span> value != <span class="string">'string'</span>) <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> value) __webpack_require__.d(ns, key, <span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123; <span class="keyword">return</span> value[key]; &#125;.bind(<span class="literal">null</span>, key));</span><br><span class="line"> 		<span class="keyword">return</span> ns;</span><br><span class="line">   &#125;;</span><br><span class="line">   </span><br><span class="line"> 	__webpack_require__.n = <span class="function"><span class="keyword">function</span>(<span class="params">module</span>) </span>&#123;</span><br><span class="line">		  <span class="keyword">var</span> getter = <span class="built_in">module</span> &amp;&amp; <span class="built_in">module</span>.__esModule ?</span><br><span class="line">			<span class="function"><span class="keyword">function</span> <span class="title">getDefault</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">module</span>[<span class="string">'default'</span>]; &#125; :</span><br><span class="line">			<span class="function"><span class="keyword">function</span> <span class="title">getModuleExports</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">module</span>; &#125;;</span><br><span class="line">		__webpack_require__.d(getter, <span class="string">'a'</span>, getter);</span><br><span class="line"> 		<span class="keyword">return</span> getter;</span><br><span class="line">   &#125;;</span><br><span class="line">   </span><br><span class="line">  __webpack_require__.o = <span class="function"><span class="keyword">function</span>(<span class="params">object, property</span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.hasOwnProperty.call(object, property); &#125;;</span><br><span class="line">  </span><br><span class="line"> 	__webpack_require__.p = <span class="string">""</span>;</span><br><span class="line"> 	<span class="keyword">return</span> __webpack_require__(__webpack_require__.s = <span class="string">"./src/index.js"</span>);</span><br><span class="line">&#125;) (&#123;</span><br><span class="line"></span><br><span class="line">  <span class="string">"./src/a.js"</span>: (<span class="function"><span class="keyword">function</span>(<span class="params">module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">"__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() &#123; return a; &#125;);\nfunction a(name) &#123;\n    return \" a \" + name;\n&#125;\n\n//# sourceURL=webpack:///./src/a.js?"</span>);</span><br><span class="line"> &#125;),</span><br><span class="line"></span><br><span class="line"> <span class="string">"./src/hello.js"</span>: (<span class="function"><span class="keyword">function</span>(<span class="params">module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">"__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"say\", function() &#123; return say; &#125;);\n/* harmony import */ var _a_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./a.js */ \"./src/a.js\");\n\nfunction say(name) &#123;\n    return \"hello \" + name + Object(_a_js__WEBPACK_IMPORTED_MODULE_0__[\"a\"])(\"test\");\n&#125;\n\n//# sourceURL=webpack:///./src/hello.js?"</span>);</span><br><span class="line">&#125;),</span><br><span class="line"></span><br><span class="line">  <span class="string">"./src/index.js"</span>: (<span class="function"><span class="keyword">function</span>(<span class="params">module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line"><span class="meta">      "use strict"</span>;</span><br><span class="line">      <span class="built_in">eval</span>(<span class="string">"__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _hello_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./hello.js */ \"./src/hello.js\");\n\n// import &#123; a &#125; from \"./a.js\";\ndocument.write(Object(_hello_js__WEBPACK_IMPORTED_MODULE_0__[\"say\"])(\"webpack\"));\n\n//# sourceURL=webpack:///./src/index.js?"</span>);</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>从上述代码可看到webpack打包文件是一个立即执行函数，<br>立即执行函数返回值是require(“./src/index.js”)<br>立即执行函数的参数是一个obj,key值为文件路径名，value为一个包裹了对应文件内容的匿名函数。<br>webpack中require方法定义如下，其中modules指传入的参数obj：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">require</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (installedModules[moduleId]) &#123;</span><br><span class="line">      <span class="keyword">return</span> installedModules[moduleId].exports;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">module</span> = (installedModules[moduleId] = &#123;</span><br><span class="line">      i: moduleId,</span><br><span class="line">      l: <span class="literal">false</span>,</span><br><span class="line">      exports: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    modules[moduleId].call(</span><br><span class="line">      <span class="built_in">module</span>.exports,</span><br><span class="line">      <span class="built_in">module</span>,</span><br><span class="line">      <span class="built_in">module</span>.exports,</span><br><span class="line">      <span class="built_in">require</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">module</span>.l = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>由参数obj,require方法我们可以试着实现一个简单的webpack compile方法<br>思路如下：</p>
<ul>
<li>1.获取入口文件路径名，入口文件依赖的文件路径名，入口文件的内容,并将内容转换成在浏览器上可执行的代码</li>
<li>2.对依赖文件重复step 1</li>
<li>3.将step 1,step2所得信息转换成参数obj格式</li>
<li>4.生成构建代码，定义require方法</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//compile.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;getAst,getDependencies,getCode&#125; <span class="keyword">from</span> <span class="string">"./parser.js"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Compile</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">    <span class="keyword">this</span>.entry = props.entry;</span><br><span class="line">    <span class="keyword">this</span>.output = props.output;</span><br><span class="line">    <span class="keyword">this</span>.moduleInfo = [];</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//将文件内容转换成浏览器可执行的代码，并获取入口文件依赖</span></span><br><span class="line">  build:<span class="function">(<span class="params">filename</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> ast = getAst(filename);</span><br><span class="line">    <span class="keyword">let</span> dependencies = getDependencies(ast,filename);</span><br><span class="line">    <span class="keyword">let</span> code = getCode(ast);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      filename,</span><br><span class="line">      dependencies,</span><br><span class="line">      code</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  run:<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">     <span class="comment">//分析入口文件，index.js</span></span><br><span class="line">        <span class="keyword">const</span> info = <span class="keyword">this</span>.build(<span class="keyword">this</span>.entry);</span><br><span class="line">        <span class="keyword">this</span>.moduleInfo.push(info);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//分析依赖文件</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.moduleInfo.length; i++) &#123;</span><br><span class="line">          <span class="keyword">const</span> item = <span class="keyword">this</span>.moduleInfo[i];</span><br><span class="line">          <span class="keyword">const</span> &#123; dependcies &#125; = item;</span><br><span class="line">          <span class="keyword">if</span> (dependcies) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> j <span class="keyword">in</span> dependcies) &#123;</span><br><span class="line">              <span class="keyword">this</span>.moduleInfo.push(<span class="keyword">this</span>.build(dependcies[j]));</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//格式转化，数组转对象</span></span><br><span class="line">        <span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">this</span>.moduleInfo.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">          obj[item.filename] = &#123;</span><br><span class="line">            dependcies: item.dependcies,</span><br><span class="line">            code: item.code</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//生成构建代码文件</span></span><br><span class="line">        <span class="keyword">this</span>.file(obj);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  file:<span class="function">(<span class="params">code</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//生成文件的路径</span></span><br><span class="line">    <span class="keyword">const</span> filePath = path.join(<span class="keyword">this</span>.output.path, <span class="keyword">this</span>.output.filename);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> obj = <span class="built_in">JSON</span>.stringify(code);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> bundle = <span class="string">`(function(obj)&#123;</span></span><br><span class="line"><span class="string">      function require(module)&#123;</span></span><br><span class="line"><span class="string">        //处理内部require</span></span><br><span class="line"><span class="string">        function localrequire(relativePath)&#123;</span></span><br><span class="line"><span class="string">          require(obj[module].dependcies[relativePath])</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        (function(require,exports,code)&#123;</span></span><br><span class="line"><span class="string">          eval(code)</span></span><br><span class="line"><span class="string">        &#125;)(localrequire,exports,obj[module].code)</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      require(`</span>$&#123;<span class="keyword">this</span>.entry&#125;<span class="string">`)</span></span><br><span class="line"><span class="string">    &#125;)(<span class="subst">$&#123;obj&#125;</span>)`</span></span><br><span class="line"></span><br><span class="line">    fs.writeFileSync(filepath,bundle,<span class="string">'utf-8'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//bundle.js</span></span><br><span class="line"><span class="keyword">const</span> options = <span class="built_in">require</span>(<span class="string">'./webpack.config.js'</span>);</span><br><span class="line"><span class="keyword">const</span> Compile = <span class="built_in">require</span>(<span class="string">'./lib/complier.js'</span>);</span><br><span class="line"><span class="keyword">new</span> Compile(options).run();</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//parser.js</span></span><br><span class="line"><span class="keyword">const</span> parser = <span class="built_in">require</span>(<span class="string">'@babel/parser'</span>);</span><br><span class="line"><span class="keyword">const</span> traverse = <span class="built_in">require</span>(<span class="string">'@babel/traverse'</span>).default;</span><br><span class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">'@babel/core'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//将文件内容转换成AST抽象语法树</span></span><br><span class="line">  getAst:<span class="function">(<span class="params">filename</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> content = fs.readFileSync(filename,<span class="string">'utf-8'</span>);</span><br><span class="line">    <span class="keyword">const</span> ast = parser.parse(content,&#123;</span><br><span class="line">      sourceType:<span class="string">"module"</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> ast</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//遍历出所有的引入模块</span></span><br><span class="line">  getDependencies:<span class="function">(<span class="params">ast,filename</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> dependencies = &#123;&#125;;</span><br><span class="line">    traverse(ast,&#123;</span><br><span class="line">      ImportDeclaration(&#123;node&#125;)&#123;</span><br><span class="line">        <span class="comment">//拼接前缀./src</span></span><br><span class="line">        <span class="keyword">const</span> newFileName = <span class="string">'./'</span> + path.join(path.dirname(filename),node.source.value);</span><br><span class="line">        dependencies[node.source.value] = newFilename;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> dependencies;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//把ast处理成浏览器可运行的代码</span></span><br><span class="line">  getCode:<span class="function">(<span class="params">ast</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;code&#125; = babel.transformFromAst(ast,<span class="literal">null</span>,&#123;</span><br><span class="line">      presets:[<span class="string">'@babel/preset-env'</span>]</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> code;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/22/react-router原理核心实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/22/react-router原理核心实现/" itemprop="url">react-router原理核心实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-22T11:07:28+08:00">
                2020-05-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>react-router秉承一切皆组件，因此实现的核心就是BrowserRouter,Route,Link。</p>
<h3 id="BrowserRouter"><a href="#BrowserRouter" class="headerlink" title="BrowserRouter"></a>BrowserRouter</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123;Component&#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Provider&#125; <span class="keyword">from</span> <span class="string">"./context.js"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createBrowserHistory&#125; <span class="keyword">from</span> <span class="string">"history"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BrowserRouter</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">            <span class="keyword">super</span>(props);</span><br><span class="line">            <span class="comment">//对于高版本浏览器，通过html5里面的history实现</span></span><br><span class="line">            <span class="keyword">this</span>.history = createBrowserHistory();</span><br><span class="line">            <span class="keyword">this</span>.state = &#123;</span><br><span class="line">                location:<span class="keyword">this</span>.history.location</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">this</span>.unListen = <span class="keyword">this</span>.history.listen(<span class="function">(<span class="params">location</span>)=&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                    location:location</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        componentWillUnmount()&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.unListen)&#123;</span><br><span class="line">                <span class="keyword">this</span>.unListen()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        render()&#123;</span><br><span class="line">            <span class="keyword">let</span> value = &#123;</span><br><span class="line">                history:<span class="keyword">this</span>.history,</span><br><span class="line">                location:<span class="keyword">this</span>.state.location</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> &lt;Provider value=&#123;value&#125;&gt;&#123;this.props.children&#125;&lt;/Provider&gt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Route"><a href="#Route" class="headerlink" title="Route"></a>Route</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Route</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;Consumer&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                (value) =&gt;&#123;</span><br><span class="line">                    <span class="keyword">let</span> &#123;path,<span class="attr">component</span>: Component,exact = <span class="literal">false</span>&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">                    <span class="keyword">let</span> pathname = value.location.pathname;</span><br><span class="line">                    <span class="comment">//对比路径,获取路径后的key与value</span></span><br><span class="line">                    <span class="keyword">let</span> keys = [];</span><br><span class="line">                    <span class="keyword">let</span> reg = pathToReg(path,keys,&#123;<span class="attr">end</span>:exact&#125;);</span><br><span class="line">                    keys = keys.map(<span class="function"><span class="params">item</span> =&gt;</span> item.name);</span><br><span class="line">                    <span class="keyword">let</span> matchResult = pathname.match(reg);</span><br><span class="line">                    <span class="keyword">let</span> [url,...values] = matchResult || [];</span><br><span class="line">                    <span class="comment">//获取match</span></span><br><span class="line">                    <span class="keyword">let</span> props = &#123;</span><br><span class="line">                        history:value.history,</span><br><span class="line">                        location:value.location,</span><br><span class="line">                        match:&#123;</span><br><span class="line">                            params:keys.reduce(<span class="function">(<span class="params">obj,current,index</span>)=&gt;</span>&#123;</span><br><span class="line">                                obj[current] = values[index];</span><br><span class="line">                                <span class="keyword">return</span> obj</span><br><span class="line">                            &#125;,&#123;&#125;)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(matchResult)&#123;</span><br><span class="line">                        <span class="keyword">return</span> &lt;Component &#123;...props&#125;&gt;&lt;/Component&gt;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            &lt;<span class="regexp">/Consumer&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Route-1"><a href="#Route-1" class="headerlink" title="Route"></a>Route</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Link</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    handleClick = <span class="function">(<span class="params">e,history</span>)=&gt;</span>&#123;</span><br><span class="line">        e.preventDefault()</span><br><span class="line">        <span class="comment">//改变url</span></span><br><span class="line">        history.push(<span class="keyword">this</span>.props.to)</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;to&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'to'</span>,to)</span><br><span class="line">        <span class="keyword">return</span>(</span><br><span class="line">            &lt;Consumer&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    (value)=&gt;&#123;</span><br><span class="line">                        <span class="keyword">return</span> &lt;a href=&#123;to&#125; onClick=&#123;(e)=&gt;this.handleClick(e,value.history)&#125;&gt;&#123;this.props.children&#125;&lt;/a&gt;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &lt;<span class="regexp">/Consumer&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/21/redux原理核心实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/21/redux原理核心实现/" itemprop="url">redux原理核心实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-21T11:59:59+08:00">
                2020-05-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="redux核心实现有四个："><a href="#redux核心实现有四个：" class="headerlink" title="redux核心实现有四个："></a>redux核心实现有四个：</h3><ul>
<li>存储状态state</li>
<li>获取状态getState</li>
<li>更新状态dispatch</li>
<li>变更订阅subscribe<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createStore</span>(<span class="params">reducer,enhancer</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(enhancer)&#123;</span><br><span class="line">        <span class="keyword">return</span> enhancer(createStore)(reducer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> currentState = <span class="literal">undefined</span>;</span><br><span class="line">    <span class="keyword">let</span> currentListeners = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getState</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentState</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span>(<span class="params">action</span>)</span>&#123;</span><br><span class="line">        currentState = reducer(currentState,action);</span><br><span class="line">        currentListeners.map(<span class="function"><span class="params">item</span> =&gt;</span> item());</span><br><span class="line">        <span class="keyword">return</span> action</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">subscribe</span>(<span class="params">cb</span>)</span>&#123;</span><br><span class="line">        currentListeners.push(cb)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//初始化状态</span></span><br><span class="line">    dispatch(&#123;<span class="attr">type</span>: <span class="string">"@@redux/INIT9.l.a.l.v.9"</span>&#125;);</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        getState,</span><br><span class="line">        dispatch,</span><br><span class="line">        subscribe</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="redux中间件实现："><a href="#redux中间件实现：" class="headerlink" title="redux中间件实现："></a>redux中间件实现：</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/21/原型链/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/21/原型链/" itemprop="url">原型链</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-21T15:12:31+08:00">
                2017-02-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<p>title: 原型链<br>date: 2017-02-20 15:35:09</p>
<h2 id="tags"><a href="#tags" class="headerlink" title="tags:"></a>tags:</h2><p>&#160; &#160; &#160; &#160;今天被问到这样一个问题：求以下输出<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Thing1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.foo = <span class="string">'foo'</span>;</span><br><span class="line">&#125;</span><br><span class="line">Thing1.prototype.foo = <span class="string">'bar'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Thing2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.logFoo();<span class="comment">//'bar'</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">  Thing1.apply(<span class="keyword">this</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">  <span class="keyword">this</span>.logFoo();<span class="comment">//'foo'</span></span><br><span class="line">&#125;</span><br><span class="line">Thing2.prototype = <span class="built_in">Object</span>.create(Thing1.prototype);</span><br><span class="line">Thing2.prototype.logFoo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.foo);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> thing = <span class="keyword">new</span> Thing2();</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;在回答这个问题之前，先来回顾一下类(Javascript语言不支持”类”，但是可以用一些变通的方法，模拟出”类”)、实例、prototype、<strong>proto</strong>的关系<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line">p1.sayName();</span><br></pre></td></tr></table></figure></p>
<p><img src="http://olq685ijo.bkt.clouddn.com/Person%E5%8E%9F%E5%9E%8B%E5%9B%BE.png" alt><br>&#160; &#160; &#160; &#160;1.我们通过函数定义了类Person,类(函数)自动获得属性prototype<br>&#160; &#160; &#160; &#160;2.每个类的实例都会有一个内部属性<strong>proto</strong>,指向类的prototype属性</p>
<p>&#160; &#160; &#160; &#160;理解了这一点我们就可以大概理解thing和Thing2的关系,</p>
<p>&#160; &#160; &#160; &#160;接着来说下<code>Object.create</code>函数和<code>.apply</code>的作用:<br>&#160; &#160; &#160; &#160;<strong>1.<code>Object.create()</code> 方法创建一个拥有指定原型和若干个指定属性的对象。</strong><br>&#160; &#160; &#160; &#160;语法：<code>Object.create(proto, {propertiesObject})</code><br>&#160; &#160; &#160; &#160;<code>proto</code>是指一个对象，作为新创建对象的原型，或者也可以是null值<br>&#160; &#160; &#160; &#160;<code>propertiesObject</code>:可选，该参数对象是一组属性与值，该对象的属性名称将是新创建对象的属性名称，值是属性描述符，例如如果：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Thing2.prototype = <span class="built_in">Object</span>.create(Thing1.prototype,&#123;</span><br><span class="line">foo: &#123;<span class="attr">value</span>: <span class="string">'hello'</span>,</span><br><span class="line">      writable: <span class="literal">true</span>,</span><br><span class="line">      configurable:<span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">bar:&#123;<span class="attr">configurable</span>:<span class="literal">false</span>,</span><br><span class="line">    <span class="keyword">get</span>:function()&#123;<span class="keyword">return</span> <span class="number">10</span>&#125;,</span><br><span class="line">    <span class="keyword">set</span>:function(value)&#123;<span class="built_in">console</span>.log(<span class="string">"Setting `o.bar` to"</span>, value&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;那么Thing2.prototype.foo的值就为’hello’,foo将成为新创建对象的数据属性，bar将成为新创建对象的访问器属性<br>&#160; &#160; &#160; &#160;<br>&#160; &#160; &#160; &#160;上题中的Thing2.prototype = Object.create(Thing1.prototype)，把Thing1.prototype赋给Thing2.prototype，也即创建了一个指定原型的对象，并把这个对象赋值给了Thing2.prototype，这里并没有指定属性，于是我们可以得到下图:<br><img src="http://olq685ijo.bkt.clouddn.com/apply%E5%8E%9F%E5%9E%8B%E5%9B%BE.png" alt><br>&#160; &#160; &#160; &#160;此时Thing2上没有foo属性，便去原型上找，找到了，为bar,因此<code>第一个输出为bar</code><br>&#160; &#160; &#160; &#160;<strong>2.<code>.apply</code>和<code>.call</code>均可以用于改变当前对象的作用域</strong><br>&#160; &#160; &#160; &#160;<code>apply</code>:<code>fun.apply(thisArg,[argsArray])</code><br>&#160; &#160; &#160; &#160;<code>thisArg</code>:在fun函数运行时指定的this值。需要注意的是，如果函数处于非严格模式下，指定为null或undefined会自动指向全局对象（浏览器中就是window对象），同时值为原始值（数字，字符串，布尔值）的this会指向该原始值的自动包装对象。<br>&#160; &#160; &#160; &#160;<code>argsArray</code>:一个数组或者类数组对象。如果该数组的值为null或undefined,则表示不需要传入任何参数,例如：<br>&#160; &#160; &#160; &#160;Math.max.apply(null,[1,2])//或者Math.max(…[1,2]) es6写法<br>&#160; &#160; &#160; &#160;Math.max.call(null,1,2)<br>&#160; &#160; &#160; &#160;apply 与 call() 非常相似，不同之处在于提供参数的方式。apply使用数组，call使用参数列表</p>
<p><pre><code><br>function Thing2(){<br>console.log(this);<br>  Thing1.apply(this);<br>}<br></code></pre><br>&#160; &#160; &#160; &#160;上述代码的apply相当于Thing2调用Thing1的constructor,于是在自身上生成了foo为’foo’的属性，于是<code>第二次输出‘foo’</code><br>&#160; &#160; &#160; &#160;因此本文前面提出的代码输出分别是‘bar’和’foo’。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/06/27/同源策略相关问答/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/06/27/同源策略相关问答/" itemprop="url">同源策略相关问答</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-06-27T10:39:01+08:00">
                2016-06-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一-什么是同源策略"><a href="#一-什么是同源策略" class="headerlink" title="一.什么是同源策略"></a>一.什么是同源策略</h3><p>&#160; &#160; &#160; &#160;什么是源：协议＋域名＋端口号，同源就是指这三者都相同；<br>&#160; &#160; &#160; &#160;同源策略：是浏览器的一个功能，即不同源的客户端脚本在没有明确授权的情况下，不能读写对方的资源。</p>
<h3 id="二-什么是跨域？跨域有几种实现形式"><a href="#二-什么是跨域？跨域有几种实现形式" class="headerlink" title="二.什么是跨域？跨域有几种实现形式"></a>二.什么是跨域？跨域有几种实现形式</h3><p>&#160; &#160; &#160; &#160;同源策略不允许跨域调用其他页面的对象，保证了web安全，但是也给网站间的数据交互带来不便，为了解决这一问题，跨域出现了，跨域是指不同域下的客户端脚本可以突破同源策略的限制,彼此之间可以进行数据交互，它有以下几种实现形式：<br>&#160; &#160; &#160; &#160;1.降域:<code>让不同源变为同源</code><br>&#160; &#160; &#160; &#160;具体的做法是可以在<code>http://www.a.com/a.html</code>和<code>http://script.a.com/b.html</code>两个文件中分别加上<code>document.domain = &#39;a.com&#39;</code>,将各自域名降为a.com<br>&#160; &#160; &#160; &#160;这种方法用得较少，因为会带来大面积的安全问题，因为它降域了，所以可以访问所有其他任何主域名相同的网站的信息，它的适用场景还局限于1.只适用于主域名相同而子域名不同的情况，2.只对拥有Src属性的标签有用<br>&#160; &#160; &#160; &#160;2.<code>jsonp</code>：利用了可以引用不同域下js的特性，比如a.com去请求b.com中的数据内容，首先会在客户端与服务器之间约定好一个函数名，然后创建一个动态script,script的src后附上约定好的函数名=xxx，b中收到请求会返回xxx({数据内容})，而xxx在a.com中是一个函数，会立即执行，b中数据被当作参数传入a中。<br>&#160; &#160; &#160; &#160;问题：<br>&#160; &#160; &#160; &#160;a.安全性问题，任何第三方网站拷贝a中js代码都可以拿到b中数据，解决办法:额外的身份校验，比如<br><code>&lt;script src=&#39;data.js?callback=xxx&amp;token=&#39;+cookie</code><br>其中var cookie=’a.com下的cookie’,因为c.com下的网页拿不到a.com下的cookie,让a、b共用一套cookie体系<br>&#160; &#160; &#160; &#160;b.不能post，只能get请求<br>&#160; &#160; &#160; &#160;c.可被注入(callback=alert(1);),比如浏览器中输入<code>b.com/data.js?call2=alert(1);</code>,会输出<code>alert(1);({&quot;name&quot;:&quot;frank&quot;,&quot;age&quot;:15})</code>解决办法:字符串过滤，比如只允许出现jQuery 1234567890之外的字符，不允许出现括号(replace)<br>&#160; &#160; &#160; &#160;3.<code>cors</code>:跨域资源共享，顾名思义它可以让服务器暴露给其它域上文件的Ajax用XMLHttpRequest调用，分为简单请求和非简单请求，具体的实现是客户端先发送一个CORS请求，服务器根据这个请求的源决定是否允许，然后在服务器端set Access-Control-Allow-Origin:源，从而返回给客户端数据。它是h5的新特性，因而不支持ie6,7,8,在ie9,10上也有问题。<br>&#160; &#160; &#160; &#160;4.[HTML5]postMessage:在请求域的文件下添加<code>windowobj.postMessage(message,targetOrigin)</code>,然后接受请求的域的文件里会有一个message的事件来监听postMessage判断消息来源地址，如果是允许的源发来的数据就可以做处理。<br>&#160; &#160; &#160; &#160;5.location.hash<br>&#160; &#160; &#160; &#160;6.window.name:利用了window.name不随域名变化而变化，只随tab页面的开启关闭而变化这一特性，比如a.com和b.com要交换数据，首先在a页面添加一个iframe,iframe指向a.com下的代理1页面，在代理1页面完成两件事，将window.name=a传给b的参数，再将域名切换到b.com，b通过window.name得到a传过来的信息，对这一信息加以处理后赋值给window.name,再切到a.com下的代理2页面，代理2页面读取window.name，并将它交给父window(a页面，iframe的父节点)的函数去处理，这时候事先定义好的函数就拿到了实参，可以该干嘛干嘛了。<br><a href="http://leanote.com/api/file/getAttach?fileId=5767ae6cab64415d8b0072c8" target="_blank" rel="noopener">降域演示.mov</a><br><a href="https://github.com/jirengu-inc/jrg-renwu3/tree/master/homework/%E5%BD%AD%E5%A8%89%E5%A9%B7/lv31-%E9%99%8D%E5%9F%9F%E6%BC%94%E7%A4%BA%E4%BB%A3%E7%A0%81" target="_blank" rel="noopener">降域演示代码</a></p>
<h3 id="三-jsonp-的原理是什么"><a href="#三-jsonp-的原理是什么" class="headerlink" title="三.jsonp 的原理是什么"></a>三.jsonp 的原理是什么</h3><p>&#160; &#160; &#160; &#160;与上题类似，就是请求的a.com创建一个动态script，在src里加入一个在a.com中已被定义的一个函数的名字，然后服务端读到这个函数名后再加括号，括号里加参数(从数据库取到的数据，数据格式一般为json)的形式返回给a.com，这样a.com就以参数传递的形式拿到了b.com的数据。<br><a href="http://leanote.com/api/file/getAttach?fileId=5767ae6cab64415d8b0072c8" target="_blank" rel="noopener">模拟JSONP降域演示.mov</a><br><a href="https://github.com/jirengu-inc/jrg-renwu3/tree/master/homework/%E5%BD%AD%E5%A8%89%E5%A9%B7/lv31-%E9%99%8D%E5%9F%9F%E6%BC%94%E7%A4%BA%E4%BB%A3%E7%A0%81/jsonp%E8%B7%A8%E5%9F%9F%E6%BC%94%E7%A4%BA%E4%BB%A3%E7%A0%81" target="_blank" rel="noopener">具体代码</a></p>
<h3 id="四-CORS是什么"><a href="#四-CORS是什么" class="headerlink" title="四.CORS是什么"></a>四.CORS是什么</h3><p>&#160; &#160; &#160; &#160;跨域资源共享，W3C标准，允许浏览器向服务器跨源的发出XMLHttpRequest请求，因为跨源，肯定需要添加一些额外的信息，其实就是一些请求头的设置，然后服务端根据你发出的这些额外信息判断我是否允许你的请求，如果我给你返回的头信息字段里有Access-Control-Allow-Origin就表示我允许了，可以返给你跨域的数据了。其他的aiax请求与同源请求无异，不支持ie6-10。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/06/27/利用负margin进行常见布局/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/06/27/利用负margin进行常见布局/" itemprop="url">利用负margin进行常见布局</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-06-27T01:04:09+08:00">
                2016-06-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-怎样使用负margin形成三栏布局呢？"><a href="#1-怎样使用负margin形成三栏布局呢？" class="headerlink" title="1.怎样使用负margin形成三栏布局呢？"></a>1.怎样使用负margin形成三栏布局呢？</h3><p>&#160; &#160; &#160; &#160;中间main设置为100%浮动，左右两侧aside也要设为浮动宽度定好，选用合适方式清除浮动；<br>&#160; &#160; &#160; &#160;两个aside使用负margin(一个为-100%，一个为-“自身宽度”)分布到main左右两侧；<br>&#160; &#160; &#160; &#160;若为圣杯三栏，则在父容器上左右padding预留两个aside区，并利用相对偏移使两aside移至padding的空白区域<br>&#160; &#160; &#160; &#160;若为双飞翼三栏，则在main区块上再内嵌一个div作为真正的中间主体部分，然后再左右margin此div到合适位置。</p>
<h3 id="2-圣杯布局的原理是怎样的-简述实现圣杯布局的步骤"><a href="#2-圣杯布局的原理是怎样的-简述实现圣杯布局的步骤" class="headerlink" title="2.圣杯布局的原理是怎样的?简述实现圣杯布局的步骤"></a>2.圣杯布局的原理是怎样的?简述实现圣杯布局的步骤</h3><p>&#160; &#160; &#160; &#160;圣杯布局的原理是利用负margin让两个浮动的固定宽度盒子进入到一个同样是浮动且自适应宽度的盒子里面去，再用相对偏移做调整。<br>&#160; &#160; &#160; &#160;步骤一：设置宽度为自适应的box main浮动，清除box浮动；<br>&#160; &#160; &#160; &#160;步骤二：设置两个固定宽度的box aside1、aside2浮动，利用负margin把它们移动到main的左右两侧；<br>&#160; &#160; &#160; &#160;步骤三：在父容器上左右padding预留两个aside区，用相对偏移让aside1、aside2微调整至padding的空白区域。</p>
<h3 id="3-双飞翼布局的原理-实现步骤"><a href="#3-双飞翼布局的原理-实现步骤" class="headerlink" title="3.双飞翼布局的原理? 实现步骤?"></a>3.双飞翼布局的原理? 实现步骤?</h3><p>&#160; &#160; &#160; &#160;双飞翼布局的原理是利用负margin让两个浮动的固定宽度盒子进入到一个同样是浮动且自适应宽度的盒子里面去，再内嵌一个div做真正的主内容区块。<br>&#160; &#160; &#160; &#160;步骤一：设置宽度为自适应的box main浮动，清除box浮动；<br>&#160; &#160; &#160; &#160;步骤二：设置两个固定宽度的box aside1、aside2浮动，利用负margin把它们移动到main的左右两侧；<br>&#160; &#160; &#160; &#160;步骤三：在main区块内再内嵌一个div作为真实的主内容，并为此div设置左右margin。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/06/25/html基础1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/06/25/html基础1/" itemprop="url">html基础(问答一)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-06-25T10:57:28+08:00">
                2016-06-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一-网页乱码是如何产生的"><a href="#一-网页乱码是如何产生的" class="headerlink" title="一.网页乱码是如何产生的"></a>一.网页乱码是如何产生的</h3><p>UNICODE给了每个字符一个代号，而GBK和UTF-8使用不同的规则来表示同一个代号，GBK用2个字节表示一个汉字，UTF-8用2～6个字节表示一个汉字。<br>乱码产生的原因在于html文件保存的编码方式与浏览器解码的方式不匹配，比如你用gbk的编码方式去保存一个汉字，两个字节，但是浏览器使用UTF-8去解码，这两个字节在UTF-8的编码规则里就不是表示一个汉字了，可能就是其他国家的语言了，这时候需要在html里加<code>&lt;meta charset=“gbk”&gt;</code>指定浏览器的解码方式为gbk。</p>
<h3 id="二-颜色有几种写法"><a href="#二-颜色有几种写法" class="headerlink" title="二.颜色有几种写法"></a>二.颜色有几种写法</h3><p>1.一些特殊的颜色可以直接用颜色名表示，比如：red,blue,black,yellow等<br>2.16进制表示法，如＃ff0000,ff代表红色，00代表绿色，00代表蓝色<br>3.rgb(255,0,0)<br>4.rgb(100%,0,0)</p>
<h3 id="三-DOCTYPE-html的作用是什么"><a href="#三-DOCTYPE-html的作用是什么" class="headerlink" title="三.DOCTYPE html的作用是什么"></a>三.DOCTYPE html的作用是什么</h3><p>声明文档的解析类型，避免浏览器的怪异模式。如果你的页面没有DOCTYPE的声明，浏览器按照自己的方式解析渲染页面，那么，在不同的浏览器就会显示不同的样式。 如果你的页面添加了<code>&lt;!DOCTYPE html&gt;</code>那么浏览器按照W3C的标准解析渲染页面，这样一来，你的页面在所有的浏览器里显示的就都是一个样子了。</p>
<h3 id="四-严格模式和混杂模式指什么"><a href="#四-严格模式和混杂模式指什么" class="headerlink" title="四.严格模式和混杂模式指什么"></a>四.严格模式和混杂模式指什么</h3><p>当Netscape4和IE4实现CSS机制时，并没有遵循W3C提出的标准。随着标准一致性变得越来越重要，浏览器开发商不得不面临一个艰难的抉择：逐渐遵循W3C的标准是前进的方向。但是改变现有CSS的实现，完整去遵循标准，会使许多网站或多或少受到破坏。<br>解决办法：所有的浏览器需要提供两种模式：混杂模式服务于旧式规则，严格模式服务于标准规则。DOCTYPE正是用来告诉浏览器使用哪种DTD(文档类型定义)。<br>1.没有DOCTYPE’意味着触发混杂模式<br>2.大部分的/新的/未知的DOCTYPE声明将触发严格模式<br>3.一些页面依据混杂模式而写，但是却包含DOCTYPE。这种情况下各个浏览器依据自己的DOCTYPE规则列表来触发混杂模式。</p>
<h3 id="五-meta-有什么作用，常见的值有哪些"><a href="#五-meta-有什么作用，常见的值有哪些" class="headerlink" title="五.meta 有什么作用，常见的值有哪些"></a>五.meta 有什么作用，常见的值有哪些</h3><p>meta可提供有关页面的元信息，比如针对搜索引擎和更新频度的描述和关键词，定义页面的使用语言，自动刷新并指向新的页面。</p>
<p>meta标签共有两个属性，它们分别是http-equiv属性和name属性。<br>1、name属性<br>　　name属性主要用于描述网页，与之对应的属性值为content，content中的内容主要是便于搜索引擎机器人查找信息和分类信息用的。<br>　　meta标签的name属性语法格式是：＜meta name=“参数” content=”具体的参数值”＞ 。<br>　　其中name属性主要有以下几种参数：<br>　　A、Keywords(关键字)，用来告诉搜索引擎你网页的关键字是什么。<br>　　B、description(网站内容描述)，用来告诉搜索引擎你的网站主要内容。<br>　　C、robots(机器人向导)，用来告诉搜索机器人哪些页面需要索引，哪些页面不需要索引。<br>　　D、author(作者)，标注网页的作者<br>2、http-equiv属性<br>　　http-equiv顾名思义，相当于http的文件头作用，它可以向浏览器传回一些有用的信息，以帮助正确和精确地显示网页内容，与之对应的属性值为content，content中的内容其实就是各个参数的变量值。<br>　　meta标签的http-equiv属性语法格式是：＜meta http-equiv=“参数” content=”参数变量值”＞ ；其中http-equiv属性主要有以下几种参数：<br>　　A、Expires(期限)，可以用于设定网页的到期时间。一旦网页过期，必须到服务器上重新传输。<br>　　B、Pragma(cache模式)，禁止浏览器从本地计算机的缓存中访问页面内容。<br>　　C、Refresh(刷新)，自动刷新并指向新页面。<br>　　D、Set-Cookie(cookie设定)，如果网页过期，那么存盘的cookie将被删除。<br>　　E、content-Type(显示字符集的设定)，设定页面使用的字符集。<br>　　用法：＜meta http-equiv=“content-Type” content=”text/html; charset=gb2312”＞</p>
<h3 id="六-常见的浏览器有哪些，什么内核"><a href="#六-常见的浏览器有哪些，什么内核" class="headerlink" title="六.常见的浏览器有哪些，什么内核"></a>六.常见的浏览器有哪些，什么内核</h3><p>IE 使用 Trident 引擎，闭源，只有微软的 IE 在使用，目前市场占有率世界第一。<br>Firefox 使用 Gecko 引擎，跨平台，就是以前的 Netscape 使用的 Mozilla 引擎，Netscape 倒了以后，成立了 Mozilla 基金会，将这个引擎完全重写，开源，市场占有率达到了第二。<br>Safari/chrome使用的引擎是苹果公司根据 KHTML 修改来的 WebKit，闭源，IPhone 上的浏览器也是用这个引擎。<br>Opera 的引擎是 Presto，闭源，也是跨平台的，速度也很快，原先的老二。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/06/23/继承/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/06/23/继承/" itemprop="url">继承</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-06-23T17:26:57+08:00">
                2016-06-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-继承有什么作用"><a href="#1-继承有什么作用" class="headerlink" title="1.继承有什么作用?"></a>1.继承有什么作用?</h3><p>&#160; &#160; &#160; &#160;提高了代码的复用性，便于扩展软件功能。</p>
<h3 id="2-有几种常见创建对象的方式-举例说明"><a href="#2-有几种常见创建对象的方式-举例说明" class="headerlink" title="2.有几种常见创建对象的方式? 举例说明?"></a>2.有几种常见创建对象的方式? 举例说明?</h3><p>&#160; &#160; &#160; &#160;1.对象字面量，无法传参</p>
<pre><code>var person={
       name:&apos;simple&apos;,
       sayName:function(){
         console.log(&apos;my name is &apos;+this.name);
     }
}
 person.sayName();
</code></pre><p>&#160; &#160; &#160; &#160;2.工厂模式,可以传参，不能识别对象类型</p>
<pre><code>function Person(name){
       var obj={
       name:&apos;simple&apos;,
       sayName:function(){
       console.log(&apos;my name is &apos;+this.name);
   }
};
  return obj;
}
 var p1=Person(&apos;simple&apos;);//实例化
 p1.sayName();//方法调用
</code></pre><p>&#160; &#160; &#160; &#160;3.构造函数,可以传参，可以识别对象类型，但会造成重复造轮子</p>
<pre><code>function Person(name){
     this.name=name;
     this.sayName=function(){
          console.log(&apos;my name is&apos;+this.name);
   }
}
  var p1=new Person(&apos;simple&apos;);
  p1.sayName();
</code></pre><p>&#160; &#160; &#160; &#160;4.原型模式</p>
<pre><code>function Person(name){
    //个性化的属性或方法
       this.name=name;
 }
Person.prototype.sayName=function(){
  console.log(&apos;my name is &apos;+this.name);
}
  var p1=new Person(&apos;simple&apos;);
  p1.sayName();
</code></pre><h3 id="3-下面两种写法有什么区别"><a href="#3-下面两种写法有什么区别" class="headerlink" title="3.下面两种写法有什么区别?"></a>3.下面两种写法有什么区别?</h3><p>&#160; &#160; &#160; &#160;</p>
<pre><code>代码//方法1
function People(name, sex){
 this.name = name;
 this.sex = sex;
 this.printName = function(){
    console.log(this.name);
  }
}
var p1 = new People(&apos;饥人谷&apos;, 2)//这种方法每new一个对象，就要创建一次printName方法，new n个，需要创建n次printName方法
//方法2
function Person(name, sex){
 this.name = name;
 this.sex = sex;
}
Person.prototype.printName = function(){
console.log(this.name);
}
var p1 = new Person(&apos;若愚&apos;, 27);//new n个对象，只需要创建1次printName方法
</code></pre><h3 id="4-Object-create-有什么作用？兼容性如何？如何使用？"><a href="#4-Object-create-有什么作用？兼容性如何？如何使用？" class="headerlink" title="4.Object.create 有什么作用？兼容性如何？如何使用？"></a>4.Object.create 有什么作用？兼容性如何？如何使用？</h3><p>&#160; &#160; &#160; &#160;Object.create(proto, [ propertiesObject ]),是ES5中提出的一种新的对象创建方式,<br>&#160; &#160;&#160;&#160;兼容性：只兼容IE9+，Chrome5+，Firefox 4.0+，Opear 11.60+,Safari 5+<br>&#160; &#160;&#160;&#160;第一个参数是要继承的原型或null,第二个参数可选,是对象的属性描述符，里面可以添加一些自定义的属性和方法。<br>&#160; &#160; &#160; &#160;propertiesObject:默认都为false<br>&#160; &#160; &#160; &#160;数据属性：<br>&#160; &#160; &#160; &#160;writable:是否可任意写<br>&#160; &#160; &#160;&#160; configurable：是否能够删除，是否能够被修改<br>&#160; &#160; &#160;&#160; enumerable：是否能用 for in 枚举<br>&#160; &#160; &#160;&#160; value：值<br>&#160; &#160; &#160;&#160;访问属性：<br>&#160; &#160; &#160;&#160; get(): 访问<br>&#160; &#160; &#160;&#160; set(): 设置</p>
<pre><code>var obj = {
    a:function(){
        console.log(100)
    },
    b:function(){
        console.log(200)
    },
    c:function(){
        console.log(300)
    }

};

 newObj = {};

var newObj = Object.create(obj,{
    t1:{
        value:&apos;yupeng&apos;,
        writable:true
    },
    bar: {
        configurable: false,
        get: function() { return bar; },
        set: function(value) { bar=value }
    }

})

console.log(newObj.a());//100
console.log(newObj.t1);//yupeng
newObj.t1=&apos;yupeng1&apos;
console.log(newObj.t1);//yupeng1  如果writable:false则为yupeng
newObj.bar=201;
console.log(newObj.bar)//通过set设值201
</code></pre><h3 id="5-hasOwnProperty有什么作用？-如何使用？"><a href="#5-hasOwnProperty有什么作用？-如何使用？" class="headerlink" title="5.hasOwnProperty有什么作用？ 如何使用？"></a>5.hasOwnProperty有什么作用？ 如何使用？</h3><p>&#160; &#160; &#160; &#160;判断实例化后的对象的属性是属于父类的还是自己的，如果是属于自己的，返回true,属于父类的，返回false</p>
<pre><code> function Person(name, sex){
  this.name=name;
  this.sex=sex;
}

Person.prototype.getName = function(){
  return this.name;
};

function Male(name, sex, age){
  // Person.call(this,name,sex);
  this.age=age;
}

Male.prototype= new Person();
var p1 = new Male(&apos;若愚&apos;, &apos;男&apos;, 27);
p1.lc=&apos;hz&apos;;
var p2 = new Male(&apos;simple&apos;, &apos;女&apos;, 18);
p1.hasOwnProperty(&apos;name&apos;)//false
p1.hasOwnProperty(&apos;sex&apos;)//false
p1.hasOwnProperty(&apos;age&apos;)//true
p1.hasOwnProperty(&apos;lc&apos;)//true
p2.hasOwnProperty(&apos;lc&apos;)//false
</code></pre><h3 id="6-实现Object-create的-polyfill"><a href="#6-实现Object-create的-polyfill" class="headerlink" title="6.实现Object.create的 polyfill"></a>6.实现Object.create的 polyfill</h3><pre><code>//不支持第二个参数
if (typeof Object.create != &apos;function&apos;) {//首先判断是否兼容
Object.create = (function() {
var Temp = function() {};
return function (prototype) {
  if (arguments.length &gt; 1) {
    throw Error(&apos;Second argument not supported&apos;);
  }
  if(prototype !== Object(prototype)) {
    throw TypeError(&apos;Argument must be an object&apos;);
  }
  if (prototype === null) {
    throw Error(&apos;null [[Prototype]] not supported&apos;);
  }
  Temp.prototype = prototype;
  var result = new Temp();
  Temp.prototype = null;
  return result;
};
 })();
 }
</code></pre><h3 id="7-如下代码中call的作用是什么"><a href="#7-如下代码中call的作用是什么" class="headerlink" title="7.如下代码中call的作用是什么?"></a>7.如下代码中call的作用是什么?</h3><pre><code>function Person(name, sex){
  this.name = name;
  this.sex = sex;
}
function Male(name, sex, age){
Person.call(this, name, sex);    //把this的作用域指向Person，因此得以继承Person的name和sex属性
this.age = age;
</code></pre><p>}</p>
<h3 id="8-补全代码，实现继承"><a href="#8-补全代码，实现继承" class="headerlink" title="8.补全代码，实现继承"></a>8.补全代码，实现继承</h3><pre><code>function Person(name, sex){
// todo ...
}

Person.prototype.getName = function(){
// todo ...
};

function Male(name, sex, age){
 //todo ...
}

//todo ...
Male.prototype.getAge = function(){
//todo ...
};

var simple = new Male(‘简单’, &apos;男&apos;, 27);
simple.printName();
</code></pre><p>&#160; &#160; &#160; &#160;法1，只能在新浏览器上运行</p>
<pre><code>function Person(name, sex){
  this.name=name;
  this.sex=sex;
}

Person.prototype.getName = function(){
  return this.name;
};

function Male(name, sex, age){
  Person.call(this,name,sex);
  this.age=age;
}

inherit(Person,Male);

Male.prototype.getAge = function(){
  return this.age;
};
Male.prototype.printName=function(){
  console.log(&quot;my name is &quot;+this.name);
}
var simple = new Male(‘简单’, &apos;男&apos;, 27);
simple.printName();

function inherit(superType,subType){
var _prototype=Object.create(superType.prototype);//拷贝一份新的prototype
_prototype.constructor=subType;//将constructor指向子类
subType.prototype=_prototype;//将子类的prototype指向新的prototype

}
</code></pre><p>&#160; &#160; &#160; &#160;法2，兼容性较好</p>
<pre><code>function Person(name, sex){
  this.name=name;
  this.sex=sex;
}

Person.prototype.getName = function(){
  return this.name;
};

function Male(name, sex, age){
  Person.call(this,name,sex);
  this.age=age;
}

Male.prototype= new Person();//new Person只是为了去获取Person里的方法
Male.prototype.constructor=Male;

Male.prototype.getAge = function(){
  return this.age;
};
Male.prototype.printName=function(){
  console.log(&quot;my name is &quot;+this.name);
}

var simple = new Male(‘简单’, &apos;男&apos;, 27);
simple.printName();
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">pingtingpeng</p>
              <p class="site-description motion-element" itemprop="description">学习总结 思考感悟 知识管理</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">pingtingpeng</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
