<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="学习总结 思考感悟 知识管理">
<meta property="og:type" content="website">
<meta property="og:title" content="pingtingpeng&#39;s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="pingtingpeng&#39;s blog">
<meta property="og:description" content="学习总结 思考感悟 知识管理">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="pingtingpeng&#39;s blog">
<meta name="twitter:description" content="学习总结 思考感悟 知识管理">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>pingtingpeng's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">pingtingpeng's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/01/05/javascript类型细节补充-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/01/05/javascript类型细节补充-2/" itemprop="url">javascript类型细节补充</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-01-05T16:33:21+08:00">
                2022-01-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/01/05/javascript类型细节补充-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/01/05/javascript类型细节补充-1/" itemprop="url">javascript类型细节补充</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-01-05T16:31:42+08:00">
                2022-01-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/01/05/javascript类型细节补充/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/01/05/javascript类型细节补充/" itemprop="url">javascript类型细节补充</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-01-05T15:51:18+08:00">
                2022-01-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>对每个前端程序员来说,JavaScript类型几乎都是最为熟悉的概念了。但是你真的很了解它们吗？我们不妨来看看下面的几个问题。</p>
<h3 id="1-为什么有的编程规范要求用-void-0-代替-undefined"><a href="#1-为什么有的编程规范要求用-void-0-代替-undefined" class="headerlink" title="1.为什么有的编程规范要求用 void 0 代替 undefined?"></a>1.为什么有的编程规范要求用 void 0 代替 undefined?</h3><p>Undefined类型表示未定义，它的类型只有一个值，就是undefined。但是呢，因为JavaScript的代码undefined是一个变量，而并非是一个关键字，这是JavaScript语言公认的设计失误之一，所以，我们为了避免无意中被篡改，建议使用void 0 来获取undefined值。</p>
<h3 id="2-Null与Undefined的区别"><a href="#2-Null与Undefined的区别" class="headerlink" title="2.Null与Undefined的区别"></a>2.Null与Undefined的区别</h3><p>Undefined类型表示未定义，它的类型只有一个值，就是undefined。任何变量在赋值前是Undefined类型、值为undefined。<br>Null表示的是：“定义了但是为空”。所以，在实际编程时，我们一般不会把变量赋值为 undefined，这样可以保证所有值为 undefined 的变量，都是从未赋值的自然状态。<br>Null是JavaScript关键字，所以在任何代码中，你都可以放心用 null 关键字来获取 null 值。</p>
<h3 id="3-字符串有最大长度吗？"><a href="#3-字符串有最大长度吗？" class="headerlink" title="3.字符串有最大长度吗？"></a>3.字符串有最大长度吗？</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/05/30/现代计算机语言分类/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/05/30/现代计算机语言分类/" itemprop="url">现代计算机语言分类</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-05-30T23:16:57+08:00">
                2021-05-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-编译，解释，混合型"><a href="#1-编译，解释，混合型" class="headerlink" title="1.编译，解释，混合型"></a>1.编译，解释，混合型</h3><p>&#160; &#160; &#160; &#160;编译型：源代码 → 词法分析 → 语法分析 → 语义分析 → 目标代码 → 链接 → 可执行文件<br>&#160; &#160; &#160; &#160;解释型：不需要编译，在运行程序的时候才逐行翻译<br>&#160; &#160; &#160; &#160;混合型：编译器将源码编译成中间码而不再是二进制机器码<br>&#160; &#160; &#160; &#160;编译型语言：C、C++、Object-C、swift、Java<br>&#160; &#160; &#160; &#160;解释型语言：JavaScript、Python、PHP<br>&#160; &#160; &#160; &#160;混合型语言：C#</p>
<h3 id="2-动态类型，静态类型"><a href="#2-动态类型，静态类型" class="headerlink" title="2.动态类型，静态类型"></a>2.动态类型，静态类型</h3><p>&#160; &#160; &#160; &#160;动态类型：类型只有在程序运行期间才能确定<br>&#160; &#160; &#160; &#160;静态类型：在程序运行前类型已知且会进行类型安全检查，这一步通常被语言解释器完成<br>&#160; &#160; &#160; &#160;动态类型语言：Python、Ruby、JavaScript;<br>&#160; &#160; &#160; &#160;静态类型语言：C、C++、C#、Java、Go;</p>
<h3 id="3-强类型，弱类型"><a href="#3-强类型，弱类型" class="headerlink" title="3.强类型，弱类型"></a>3.强类型，弱类型</h3><p>&#160; &#160; &#160; &#160;强类型：偏向于不容忍隐式类型转换<br>&#160; &#160; &#160; &#160;弱类型：偏向于容忍隐式类型转换<br>&#160; &#160; &#160; &#160;强类型：Java、Python、Go;<br>&#160; &#160; &#160; &#160;弱类型：Javascript、C、C++;</p>
<h3 id="4-命令式，声明式"><a href="#4-命令式，声明式" class="headerlink" title="4.命令式，声明式"></a>4.命令式，声明式</h3><h4 id="命令式："><a href="#命令式：" class="headerlink" title="命令式："></a>命令式：</h4><p>&#160; &#160; &#160; &#160; 1.过程式：fortran,pascal,basic,c…<br>&#160; &#160; &#160; &#160; 2.面向对象：c++,java,c#,Ruby,smalltalk…<br>&#160; &#160; &#160; &#160; 3.既面向对象又面向过程：Python<br>&#160; &#160; &#160; &#160; 4.其他：javascript</p>
<h4 id="声明式"><a href="#声明式" class="headerlink" title="声明式:"></a>声明式:</h4><p>&#160; &#160; &#160; &#160;1.函数式：lisp,scheme,haskell<br>&#160; &#160; &#160; &#160;2.数据流：sisal,vhdl<br>&#160; &#160; &#160; &#160;3.逻辑式：prolog</p>
<h3 id="5-低级，高级"><a href="#5-低级，高级" class="headerlink" title="5.低级，高级"></a>5.低级，高级</h3><p>&#160; &#160; &#160; &#160;高级：C、C++、Java、Python、Pascal、Lisp、Prolog、FoxPro…<br>&#160; &#160; &#160; &#160;低级：机器语言(0 1),汇编语言</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/09/设计模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/10/09/设计模式/" itemprop="url">设计模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-10-09T16:30:50+08:00">
                2020-10-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一-创建型模式"><a href="#一-创建型模式" class="headerlink" title="一.创建型模式"></a>一.创建型模式</h2><h3 id="1-工厂方法模式"><a href="#1-工厂方法模式" class="headerlink" title="1.工厂方法模式"></a>1.工厂方法模式</h3><p>&#160; &#160; &#160; &#160;适用场景：无法预知对象确切类别及其依赖关系<br>&#160; &#160; &#160; &#160;以下代码仅为示意，并不严谨，适用typeScript语言<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Application</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">const</span> dialog = <span class="keyword">new</span> Dialog()</span><br><span class="line">    &#125;</span><br><span class="line">    init = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> config = readApplicationConfigFile()</span><br><span class="line">         <span class="keyword">if</span> (config.OS == <span class="string">"Windows"</span>)</span><br><span class="line">            dialog = <span class="keyword">new</span> WindowsDialog()</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (config.OS == <span class="string">"Web"</span>)</span><br><span class="line">            dialog = <span class="keyword">new</span> WebDialog()</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"错误！未知的操作系统。"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    main = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.init()</span><br><span class="line">        dialog.render()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dialog</span></span>&#123;</span><br><span class="line">    createButton = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    render = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WindowsDialog</span> <span class="keyword">extends</span> <span class="title">Dialog</span></span>&#123;</span><br><span class="line">    createButton = <span class="function"><span class="params">()</span>=&gt;</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> WindowsButton()&#125;</span><br><span class="line"></span><br><span class="line">    render = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebDialog</span> <span class="keyword">extends</span> <span class="title">Dialog</span></span>&#123;</span><br><span class="line">    createButton = <span class="function"><span class="params">()</span>=&gt;</span>&#123;<span class="keyword">return</span> <span class="keyword">new</span> HTMLButton()&#125;</span><br><span class="line"></span><br><span class="line">    render = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface Button&#123;</span><br><span class="line">    onClick = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    render = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WindowsButton</span> <span class="title">implements</span> <span class="title">Button</span></span>&#123;</span><br><span class="line">    onClick = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    render = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HTMLButton</span> <span class="title">implements</span> <span class="title">Button</span></span>&#123;</span><br><span class="line">    onClick = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    render = <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-抽象工厂模式"><a href="#2-抽象工厂模式" class="headerlink" title="2.抽象工厂模式"></a>2.抽象工厂模式</h3><p>&#160; &#160; &#160; &#160;适用场景：代码需要与多个不同系列的相关产品交互。接口interface-&gt;创造出不同系列的产品</p>
<h3 id="3-生成器模式"><a href="#3-生成器模式" class="headerlink" title="3.生成器模式"></a>3.生成器模式</h3><p>&#160; &#160; &#160; &#160;适用场景：避免 “重叠构造函数” 的出现(new House(4,2,4,true,null,null,null,……))</p>
<h3 id="4-原型模式"><a href="#4-原型模式" class="headerlink" title="4.原型模式"></a>4.原型模式</h3><p>&#160; &#160; &#160; &#160;适用场景:想生成一个完全相同的对象，但是私有成员变量不可被复制<br>需要复制一些对象， 同时又希望代码独立于这些对象所属的具体类， 可以使用原型模式。</p>
<h3 id="5-单例模式"><a href="#5-单例模式" class="headerlink" title="5.单例模式"></a>5.单例模式</h3><p>&#160; &#160; &#160; &#160;适用场景:保证一个类只有一个实例， 并提供一个访问该实例的全局节点</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/22/实现一个类React框架/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/22/实现一个类React框架/" itemprop="url">实现一个类React框架</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-22T01:25:01+08:00">
                2020-07-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>step1:环境搭建<br>step2:实dom渲染的TReact实现<br>//main.js<br>import {TReact} from “./TReact.js”;<br>let a = <div name="a" id="ida"><br>        <span>Hello</span><br>        <span>Hello</span><br>        <span>Hello</span><br></div><br> document.body.appendChild(a)<br> //TReact.js</p>
<p> export let TReact={<br>     createElement(type,attributes,…children){<br>         //创建真实dom<br>         let element = document.createElement(type)<br>         //塞上属性<br>         for(let name in attributes){<br>             element.setAttribute(name,attributes[name])<br>         }<br>         //加上children(考虑文本)<br>         for(let child of children){<br>             if(typeof child === ‘string’)<br>                child = document.createTextNode(child)<br>             element.appendChild(child)<br>         }<br>         return element<br>     }<br> }</p>
<p> //加入是react的话<br> import React from “react”<br> import ReactDOM from “react-dom”;<br> let a = <div name="a" id="ida"><br>        <span>Hello</span><br>        <span>Hello</span><br>        <span>Hello</span><br></div><br>ReactDOM.render(<br>    a,<br>    document.getElementById(‘root’)<br>)</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/28/webpack打包原理分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/28/webpack打包原理分析/" itemprop="url">webpack打包原理分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-28T23:55:35+08:00">
                2020-05-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>既然是分析打包原理，先看看webpack打包后的代码：<br><em>说明：webpack version:4.43.0,项目结构：</em><br>|——dist<br>|——lib<br>|——src——|——index.js<br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|——hello.js<br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|——a.js<br>|<br>|——bundle.js<br>|——package.json<br>|——webpack.config.js<br><em>已去掉注释,入口文件为index.js,index.js引用hello.js,hello.js引用a.js</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"> (<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>) </span>&#123; </span><br><span class="line"></span><br><span class="line"> 	<span class="keyword">var</span> installedModules = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"> 	<span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(installedModules[moduleId]) &#123;</span><br><span class="line">			<span class="keyword">return</span> installedModules[moduleId].exports;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> <span class="built_in">module</span> = installedModules[moduleId] = &#123;</span><br><span class="line">			i: moduleId,</span><br><span class="line">			l: <span class="literal">false</span>,</span><br><span class="line">		  exports: &#123;&#125;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		modules[moduleId].call(<span class="built_in">module</span>.exports, <span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">module</span>.l = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">	&#125;</span><br><span class="line">	__webpack_require__.m = modules;</span><br><span class="line"></span><br><span class="line"> 	__webpack_require__.c = installedModules;</span><br><span class="line"></span><br><span class="line">	__webpack_require__.d = <span class="function"><span class="keyword">function</span>(<span class="params">exports, name, getter</span>) </span>&#123;</span><br><span class="line"> 		<span class="keyword">if</span>(!__webpack_require__.o(exports, name)) &#123;</span><br><span class="line">			<span class="built_in">Object</span>.defineProperty(exports, name, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">get</span>: getter &#125;);</span><br><span class="line"> 		&#125;</span><br><span class="line">   &#125;;</span><br><span class="line">   </span><br><span class="line"> 	__webpack_require__.r = <span class="function"><span class="keyword">function</span>(<span class="params">exports</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">Symbol</span> !== <span class="string">'undefined'</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag) &#123;</span><br><span class="line">		<span class="built_in">Object</span>.defineProperty(exports, <span class="built_in">Symbol</span>.toStringTag, &#123; <span class="attr">value</span>: <span class="string">'Module'</span> &#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	  <span class="built_in">Object</span>.defineProperty(exports, <span class="string">'__esModule'</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line"> 	__webpack_require__.t = <span class="function"><span class="keyword">function</span>(<span class="params">value, mode</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(mode &amp; <span class="number">1</span>) value = __webpack_require__(value);</span><br><span class="line">		<span class="keyword">if</span>(mode &amp; <span class="number">8</span>) <span class="keyword">return</span> value;</span><br><span class="line"> 		<span class="keyword">if</span>((mode &amp; <span class="number">4</span>) &amp;&amp; <span class="keyword">typeof</span> value === <span class="string">'object'</span> &amp;&amp; value &amp;&amp; value.__esModule) <span class="keyword">return</span> value;</span><br><span class="line"> 		<span class="keyword">var</span> ns = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">	  __webpack_require__.r(ns);</span><br><span class="line">	  <span class="built_in">Object</span>.defineProperty(ns, <span class="string">'default'</span>, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">value</span>: value &#125;);</span><br><span class="line">		<span class="keyword">if</span>(mode &amp; <span class="number">2</span> &amp;&amp; <span class="keyword">typeof</span> value != <span class="string">'string'</span>) <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> value) __webpack_require__.d(ns, key, <span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123; <span class="keyword">return</span> value[key]; &#125;.bind(<span class="literal">null</span>, key));</span><br><span class="line"> 		<span class="keyword">return</span> ns;</span><br><span class="line">   &#125;;</span><br><span class="line">   </span><br><span class="line"> 	__webpack_require__.n = <span class="function"><span class="keyword">function</span>(<span class="params">module</span>) </span>&#123;</span><br><span class="line">		  <span class="keyword">var</span> getter = <span class="built_in">module</span> &amp;&amp; <span class="built_in">module</span>.__esModule ?</span><br><span class="line">			<span class="function"><span class="keyword">function</span> <span class="title">getDefault</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">module</span>[<span class="string">'default'</span>]; &#125; :</span><br><span class="line">			<span class="function"><span class="keyword">function</span> <span class="title">getModuleExports</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">module</span>; &#125;;</span><br><span class="line">		__webpack_require__.d(getter, <span class="string">'a'</span>, getter);</span><br><span class="line"> 		<span class="keyword">return</span> getter;</span><br><span class="line">   &#125;;</span><br><span class="line">   </span><br><span class="line">  __webpack_require__.o = <span class="function"><span class="keyword">function</span>(<span class="params">object, property</span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.hasOwnProperty.call(object, property); &#125;;</span><br><span class="line">  </span><br><span class="line"> 	__webpack_require__.p = <span class="string">""</span>;</span><br><span class="line"> 	<span class="keyword">return</span> __webpack_require__(__webpack_require__.s = <span class="string">"./src/index.js"</span>);</span><br><span class="line">&#125;) (&#123;</span><br><span class="line"></span><br><span class="line">  <span class="string">"./src/a.js"</span>: (<span class="function"><span class="keyword">function</span>(<span class="params">module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">"__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() &#123; return a; &#125;);\nfunction a(name) &#123;\n    return \" a \" + name;\n&#125;\n\n//# sourceURL=webpack:///./src/a.js?"</span>);</span><br><span class="line"> &#125;),</span><br><span class="line"></span><br><span class="line"> <span class="string">"./src/hello.js"</span>: (<span class="function"><span class="keyword">function</span>(<span class="params">module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">"__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"say\", function() &#123; return say; &#125;);\n/* harmony import */ var _a_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./a.js */ \"./src/a.js\");\n\nfunction say(name) &#123;\n    return \"hello \" + name + Object(_a_js__WEBPACK_IMPORTED_MODULE_0__[\"a\"])(\"test\");\n&#125;\n\n//# sourceURL=webpack:///./src/hello.js?"</span>);</span><br><span class="line">&#125;),</span><br><span class="line"></span><br><span class="line">  <span class="string">"./src/index.js"</span>: (<span class="function"><span class="keyword">function</span>(<span class="params">module, __webpack_exports__, __webpack_require__</span>) </span>&#123;</span><br><span class="line"><span class="meta">      "use strict"</span>;</span><br><span class="line">      <span class="built_in">eval</span>(<span class="string">"__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _hello_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./hello.js */ \"./src/hello.js\");\n\n// import &#123; a &#125; from \"./a.js\";\ndocument.write(Object(_hello_js__WEBPACK_IMPORTED_MODULE_0__[\"say\"])(\"webpack\"));\n\n//# sourceURL=webpack:///./src/index.js?"</span>);</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>从上述代码可看到webpack打包文件是一个立即执行函数，<br>立即执行函数返回值是require(“./src/index.js”)<br>立即执行函数的参数是一个obj,key值为文件路径名，value为一个包裹了对应文件内容的匿名函数。<br>webpack中require方法定义如下，其中modules指传入的参数obj：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">require</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (installedModules[moduleId]) &#123;</span><br><span class="line">      <span class="keyword">return</span> installedModules[moduleId].exports;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">module</span> = (installedModules[moduleId] = &#123;</span><br><span class="line">      i: moduleId,</span><br><span class="line">      l: <span class="literal">false</span>,</span><br><span class="line">      exports: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    modules[moduleId].call(</span><br><span class="line">      <span class="built_in">module</span>.exports,</span><br><span class="line">      <span class="built_in">module</span>,</span><br><span class="line">      <span class="built_in">module</span>.exports,</span><br><span class="line">      <span class="built_in">require</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">module</span>.l = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>由参数obj,require方法我们可以试着实现一个简单的webpack compile方法<br>思路如下：</p>
<ul>
<li>1.获取入口文件路径名，入口文件依赖的文件路径名，入口文件的内容,并将内容转换成在浏览器上可执行的代码</li>
<li>2.对依赖文件重复step 1</li>
<li>3.将step 1,step2所得信息转换成参数obj格式</li>
<li>4.生成构建代码，定义require方法</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//compile.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;getAst,getDependencies,getCode&#125; <span class="keyword">from</span> <span class="string">"./parser.js"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Compile</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">    <span class="keyword">this</span>.entry = props.entry;</span><br><span class="line">    <span class="keyword">this</span>.output = props.output;</span><br><span class="line">    <span class="keyword">this</span>.moduleInfo = [];</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//将文件内容转换成浏览器可执行的代码，并获取入口文件依赖</span></span><br><span class="line">  build:<span class="function">(<span class="params">filename</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> ast = getAst(filename);</span><br><span class="line">    <span class="keyword">let</span> dependencies = getDependencies(ast,filename);</span><br><span class="line">    <span class="keyword">let</span> code = getCode(ast);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      filename,</span><br><span class="line">      dependencies,</span><br><span class="line">      code</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  run:<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">     <span class="comment">//分析入口文件，index.js</span></span><br><span class="line">        <span class="keyword">const</span> info = <span class="keyword">this</span>.build(<span class="keyword">this</span>.entry);</span><br><span class="line">        <span class="keyword">this</span>.moduleInfo.push(info);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//分析依赖文件</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.moduleInfo.length; i++) &#123;</span><br><span class="line">          <span class="keyword">const</span> item = <span class="keyword">this</span>.moduleInfo[i];</span><br><span class="line">          <span class="keyword">const</span> &#123; dependcies &#125; = item;</span><br><span class="line">          <span class="keyword">if</span> (dependcies) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> j <span class="keyword">in</span> dependcies) &#123;</span><br><span class="line">              <span class="keyword">this</span>.moduleInfo.push(<span class="keyword">this</span>.build(dependcies[j]));</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//格式转化，数组转对象</span></span><br><span class="line">        <span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">this</span>.moduleInfo.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">          obj[item.filename] = &#123;</span><br><span class="line">            dependcies: item.dependcies,</span><br><span class="line">            code: item.code</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//生成构建代码文件</span></span><br><span class="line">        <span class="keyword">this</span>.file(obj);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  file:<span class="function">(<span class="params">code</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//生成文件的路径</span></span><br><span class="line">    <span class="keyword">const</span> filePath = path.join(<span class="keyword">this</span>.output.path, <span class="keyword">this</span>.output.filename);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> obj = <span class="built_in">JSON</span>.stringify(code);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> bundle = <span class="string">`(function(obj)&#123;</span></span><br><span class="line"><span class="string">      function require(module)&#123;</span></span><br><span class="line"><span class="string">        //处理内部require</span></span><br><span class="line"><span class="string">        function localrequire(relativePath)&#123;</span></span><br><span class="line"><span class="string">          require(obj[module].dependcies[relativePath])</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        (function(require,exports,code)&#123;</span></span><br><span class="line"><span class="string">          eval(code)</span></span><br><span class="line"><span class="string">        &#125;)(localrequire,exports,obj[module].code)</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      require(`</span>$&#123;<span class="keyword">this</span>.entry&#125;<span class="string">`)</span></span><br><span class="line"><span class="string">    &#125;)(<span class="subst">$&#123;obj&#125;</span>)`</span></span><br><span class="line"></span><br><span class="line">    fs.writeFileSync(filepath,bundle,<span class="string">'utf-8'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//bundle.js</span></span><br><span class="line"><span class="keyword">const</span> options = <span class="built_in">require</span>(<span class="string">'./webpack.config.js'</span>);</span><br><span class="line"><span class="keyword">const</span> Compile = <span class="built_in">require</span>(<span class="string">'./lib/complier.js'</span>);</span><br><span class="line"><span class="keyword">new</span> Compile(options).run();</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//parser.js</span></span><br><span class="line"><span class="keyword">const</span> parser = <span class="built_in">require</span>(<span class="string">'@babel/parser'</span>);</span><br><span class="line"><span class="keyword">const</span> traverse = <span class="built_in">require</span>(<span class="string">'@babel/traverse'</span>).default;</span><br><span class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">'@babel/core'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//将文件内容转换成AST抽象语法树</span></span><br><span class="line">  getAst:<span class="function">(<span class="params">filename</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> content = fs.readFileSync(filename,<span class="string">'utf-8'</span>);</span><br><span class="line">    <span class="keyword">const</span> ast = parser.parse(content,&#123;</span><br><span class="line">      sourceType:<span class="string">"module"</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> ast</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//遍历出所有的引入模块</span></span><br><span class="line">  getDependencies:<span class="function">(<span class="params">ast,filename</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> dependencies = &#123;&#125;;</span><br><span class="line">    traverse(ast,&#123;</span><br><span class="line">      ImportDeclaration(&#123;node&#125;)&#123;</span><br><span class="line">        <span class="comment">//拼接前缀./src</span></span><br><span class="line">        <span class="keyword">const</span> newFileName = <span class="string">'./'</span> + path.join(path.dirname(filename),node.source.value);</span><br><span class="line">        dependencies[node.source.value] = newFilename;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> dependencies;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//把ast处理成浏览器可运行的代码</span></span><br><span class="line">  getCode:<span class="function">(<span class="params">ast</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;code&#125; = babel.transformFromAst(ast,<span class="literal">null</span>,&#123;</span><br><span class="line">      presets:[<span class="string">'@babel/preset-env'</span>]</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> code;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/22/react-router原理核心实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/22/react-router原理核心实现/" itemprop="url">react-router原理核心实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-22T11:07:28+08:00">
                2020-05-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>react-router秉承一切皆组件，因此实现的核心就是BrowserRouter,Route,Link。</p>
<h3 id="BrowserRouter"><a href="#BrowserRouter" class="headerlink" title="BrowserRouter"></a>BrowserRouter</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123;Component&#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Provider&#125; <span class="keyword">from</span> <span class="string">"./context.js"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createBrowserHistory&#125; <span class="keyword">from</span> <span class="string">"history"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BrowserRouter</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">            <span class="keyword">super</span>(props);</span><br><span class="line">            <span class="comment">//对于高版本浏览器，通过html5里面的history实现</span></span><br><span class="line">            <span class="keyword">this</span>.history = createBrowserHistory();</span><br><span class="line">            <span class="keyword">this</span>.state = &#123;</span><br><span class="line">                location:<span class="keyword">this</span>.history.location</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">this</span>.unListen = <span class="keyword">this</span>.history.listen(<span class="function">(<span class="params">location</span>)=&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                    location:location</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        componentWillUnmount()&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.unListen)&#123;</span><br><span class="line">                <span class="keyword">this</span>.unListen()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        render()&#123;</span><br><span class="line">            <span class="keyword">let</span> value = &#123;</span><br><span class="line">                history:<span class="keyword">this</span>.history,</span><br><span class="line">                location:<span class="keyword">this</span>.state.location</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> &lt;Provider value=&#123;value&#125;&gt;&#123;this.props.children&#125;&lt;/Provider&gt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Route"><a href="#Route" class="headerlink" title="Route"></a>Route</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Route</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;Consumer&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                (value) =&gt;&#123;</span><br><span class="line">                    <span class="keyword">let</span> &#123;path,<span class="attr">component</span>: Component,exact = <span class="literal">false</span>&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">                    <span class="keyword">let</span> pathname = value.location.pathname;</span><br><span class="line">                    <span class="comment">//对比路径,获取路径后的key与value</span></span><br><span class="line">                    <span class="keyword">let</span> keys = [];</span><br><span class="line">                    <span class="keyword">let</span> reg = pathToReg(path,keys,&#123;<span class="attr">end</span>:exact&#125;);</span><br><span class="line">                    keys = keys.map(<span class="function"><span class="params">item</span> =&gt;</span> item.name);</span><br><span class="line">                    <span class="keyword">let</span> matchResult = pathname.match(reg);</span><br><span class="line">                    <span class="keyword">let</span> [url,...values] = matchResult || [];</span><br><span class="line">                    <span class="comment">//获取match</span></span><br><span class="line">                    <span class="keyword">let</span> props = &#123;</span><br><span class="line">                        history:value.history,</span><br><span class="line">                        location:value.location,</span><br><span class="line">                        match:&#123;</span><br><span class="line">                            params:keys.reduce(<span class="function">(<span class="params">obj,current,index</span>)=&gt;</span>&#123;</span><br><span class="line">                                obj[current] = values[index];</span><br><span class="line">                                <span class="keyword">return</span> obj</span><br><span class="line">                            &#125;,&#123;&#125;)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(matchResult)&#123;</span><br><span class="line">                        <span class="keyword">return</span> &lt;Component &#123;...props&#125;&gt;&lt;/Component&gt;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            &lt;<span class="regexp">/Consumer&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Route-1"><a href="#Route-1" class="headerlink" title="Route"></a>Route</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Link</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    handleClick = <span class="function">(<span class="params">e,history</span>)=&gt;</span>&#123;</span><br><span class="line">        e.preventDefault()</span><br><span class="line">        <span class="comment">//改变url</span></span><br><span class="line">        history.push(<span class="keyword">this</span>.props.to)</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;to&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'to'</span>,to)</span><br><span class="line">        <span class="keyword">return</span>(</span><br><span class="line">            &lt;Consumer&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    (value)=&gt;&#123;</span><br><span class="line">                        <span class="keyword">return</span> &lt;a href=&#123;to&#125; onClick=&#123;(e)=&gt;this.handleClick(e,value.history)&#125;&gt;&#123;this.props.children&#125;&lt;/a&gt;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &lt;<span class="regexp">/Consumer&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/21/redux原理核心实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/21/redux原理核心实现/" itemprop="url">redux原理核心实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-21T11:59:59+08:00">
                2020-05-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="redux核心实现有四个："><a href="#redux核心实现有四个：" class="headerlink" title="redux核心实现有四个："></a>redux核心实现有四个：</h3><ul>
<li>存储状态state</li>
<li>获取状态getState</li>
<li>更新状态dispatch</li>
<li>变更订阅subscribe<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createStore</span>(<span class="params">reducer,enhancer</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(enhancer)&#123;</span><br><span class="line">        <span class="keyword">return</span> enhancer(createStore)(reducer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> currentState = <span class="literal">undefined</span>;</span><br><span class="line">    <span class="keyword">let</span> currentListeners = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getState</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentState</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span>(<span class="params">action</span>)</span>&#123;</span><br><span class="line">        currentState = reducer(currentState,action);</span><br><span class="line">        currentListeners.map(<span class="function"><span class="params">item</span> =&gt;</span> item());</span><br><span class="line">        <span class="keyword">return</span> action</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">subscribe</span>(<span class="params">cb</span>)</span>&#123;</span><br><span class="line">        currentListeners.push(cb)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//初始化状态</span></span><br><span class="line">    dispatch(&#123;<span class="attr">type</span>: <span class="string">"@@redux/INIT9.l.a.l.v.9"</span>&#125;);</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        getState,</span><br><span class="line">        dispatch,</span><br><span class="line">        subscribe</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="redux中间件实现："><a href="#redux中间件实现：" class="headerlink" title="redux中间件实现："></a>redux中间件实现：</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/21/原型链/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="pingtingpeng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="pingtingpeng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/21/原型链/" itemprop="url">原型链</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-21T15:12:31+08:00">
                2017-02-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<p>title: 原型链<br>date: 2017-02-20 15:35:09</p>
<h2 id="tags"><a href="#tags" class="headerlink" title="tags:"></a>tags:</h2><p>&#160; &#160; &#160; &#160;今天被问到这样一个问题：求以下输出<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Thing1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.foo = <span class="string">'foo'</span>;</span><br><span class="line">&#125;</span><br><span class="line">Thing1.prototype.foo = <span class="string">'bar'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Thing2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.logFoo();<span class="comment">//'bar'</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">  Thing1.apply(<span class="keyword">this</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">  <span class="keyword">this</span>.logFoo();<span class="comment">//'foo'</span></span><br><span class="line">&#125;</span><br><span class="line">Thing2.prototype = <span class="built_in">Object</span>.create(Thing1.prototype);</span><br><span class="line">Thing2.prototype.logFoo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.foo);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> thing = <span class="keyword">new</span> Thing2();</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;在回答这个问题之前，先来回顾一下类(Javascript语言不支持”类”，但是可以用一些变通的方法，模拟出”类”)、实例、prototype、<strong>proto</strong>的关系<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line">p1.sayName();</span><br></pre></td></tr></table></figure></p>
<p><img src="http://olq685ijo.bkt.clouddn.com/Person%E5%8E%9F%E5%9E%8B%E5%9B%BE.png" alt><br>&#160; &#160; &#160; &#160;1.我们通过函数定义了类Person,类(函数)自动获得属性prototype<br>&#160; &#160; &#160; &#160;2.每个类的实例都会有一个内部属性<strong>proto</strong>,指向类的prototype属性</p>
<p>&#160; &#160; &#160; &#160;理解了这一点我们就可以大概理解thing和Thing2的关系,</p>
<p>&#160; &#160; &#160; &#160;接着来说下<code>Object.create</code>函数和<code>.apply</code>的作用:<br>&#160; &#160; &#160; &#160;<strong>1.<code>Object.create()</code> 方法创建一个拥有指定原型和若干个指定属性的对象。</strong><br>&#160; &#160; &#160; &#160;语法：<code>Object.create(proto, {propertiesObject})</code><br>&#160; &#160; &#160; &#160;<code>proto</code>是指一个对象，作为新创建对象的原型，或者也可以是null值<br>&#160; &#160; &#160; &#160;<code>propertiesObject</code>:可选，该参数对象是一组属性与值，该对象的属性名称将是新创建对象的属性名称，值是属性描述符，例如如果：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Thing2.prototype = <span class="built_in">Object</span>.create(Thing1.prototype,&#123;</span><br><span class="line">foo: &#123;<span class="attr">value</span>: <span class="string">'hello'</span>,</span><br><span class="line">      writable: <span class="literal">true</span>,</span><br><span class="line">      configurable:<span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">bar:&#123;<span class="attr">configurable</span>:<span class="literal">false</span>,</span><br><span class="line">    <span class="keyword">get</span>:function()&#123;<span class="keyword">return</span> <span class="number">10</span>&#125;,</span><br><span class="line">    <span class="keyword">set</span>:function(value)&#123;<span class="built_in">console</span>.log(<span class="string">"Setting `o.bar` to"</span>, value&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>&#160; &#160; &#160; &#160;那么Thing2.prototype.foo的值就为’hello’,foo将成为新创建对象的数据属性，bar将成为新创建对象的访问器属性<br>&#160; &#160; &#160; &#160;<br>&#160; &#160; &#160; &#160;上题中的Thing2.prototype = Object.create(Thing1.prototype)，把Thing1.prototype赋给Thing2.prototype，也即创建了一个指定原型的对象，并把这个对象赋值给了Thing2.prototype，这里并没有指定属性，于是我们可以得到下图:<br><img src="http://olq685ijo.bkt.clouddn.com/apply%E5%8E%9F%E5%9E%8B%E5%9B%BE.png" alt><br>&#160; &#160; &#160; &#160;此时Thing2上没有foo属性，便去原型上找，找到了，为bar,因此<code>第一个输出为bar</code><br>&#160; &#160; &#160; &#160;<strong>2.<code>.apply</code>和<code>.call</code>均可以用于改变当前对象的作用域</strong><br>&#160; &#160; &#160; &#160;<code>apply</code>:<code>fun.apply(thisArg,[argsArray])</code><br>&#160; &#160; &#160; &#160;<code>thisArg</code>:在fun函数运行时指定的this值。需要注意的是，如果函数处于非严格模式下，指定为null或undefined会自动指向全局对象（浏览器中就是window对象），同时值为原始值（数字，字符串，布尔值）的this会指向该原始值的自动包装对象。<br>&#160; &#160; &#160; &#160;<code>argsArray</code>:一个数组或者类数组对象。如果该数组的值为null或undefined,则表示不需要传入任何参数,例如：<br>&#160; &#160; &#160; &#160;Math.max.apply(null,[1,2])//或者Math.max(…[1,2]) es6写法<br>&#160; &#160; &#160; &#160;Math.max.call(null,1,2)<br>&#160; &#160; &#160; &#160;apply 与 call() 非常相似，不同之处在于提供参数的方式。apply使用数组，call使用参数列表</p>
<p><pre><code><br>function Thing2(){<br>console.log(this);<br>  Thing1.apply(this);<br>}<br></code></pre><br>&#160; &#160; &#160; &#160;上述代码的apply相当于Thing2调用Thing1的constructor,于是在自身上生成了foo为’foo’的属性，于是<code>第二次输出‘foo’</code><br>&#160; &#160; &#160; &#160;因此本文前面提出的代码输出分别是‘bar’和’foo’。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">pingtingpeng</p>
              <p class="site-description motion-element" itemprop="description">学习总结 思考感悟 知识管理</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">pingtingpeng</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
